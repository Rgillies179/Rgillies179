<!doctype html>

<html lang="en">

<head>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>To Do List</title>

  <link rel="icon" href="/favicon.ico">
  <link rel="icon" href="/favicon.svg" type="image/svg+xml">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">

  <link rel="stylesheet" href="ToDoList.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>

<body>
  <!--Navigation bar -->
  <div id="nav-placeholder"></div>

  <script>
    //Takes the code from navigation.html and run it here
    $.get("../navigation.html", function (data) {
      $("#nav-placeholder").replaceWith(data);
    });

  </script>
  <!--end of Navigation bar-->

  <script>
    
    (function() {

      var taskList = {
        //insates the function
        init: function() {
          var inputButton = document.getElementById("inputButton");
          inputButton.addEventListener("Click", taskList.createNewTask )
        
      
          //allows you to submit a new task with enter
      document.onKeyDown = function (e) {
        if(e.which == 13) {
          taskList.createNewTask();
        }
      }

      document.addEventListener("mousemove", taskList.moveTask)

      taskList.getAllTasks();

    },
    
    data: ["go to shop", "write code", "exercise"],

    moving: false,

    element: '',
    //creates a new task when you click enter/submit
    createNewTask:function() {
      var input = document.getElementById('new-Task');
      if(input.value !== '') {
        taskList.data.push(input.value);
        input.value = '';

        taskList.getAllTasks();
      }
    },
    
    getAllTasks: function(){
      var list = document.getElementById('list');
      list.innerHTML = '';

      for(var i = 0; i < taskList.data.length; i++) {
        var task = document.createElement("li");
        task.className = "task";
        task.setAttribute("data-id", i);
        task.innerHTML = '<div class="delete">x</div class="text"> #' + (i + 1) + ": " + taskList.data[i] + "</div>";

        task.children[0].addEventListener("click", taskList.deleteTask);
        task.children[1].addEventListener("mousedown", function(e) { 
					e.target.parentNode.className += " moving"; 

					taskList.moving = true;
					taskList.element = e.target.parentNode;
          
          
				});

        task.children[1].addEventListener("mouseup", function(e) {
					e.target.parentNode.className = "task";

          taskList.moving = false;
          taskList.adjustTaskOrder(e);
        });

        list.appendChild(task);
      }
    },

    moveTask:function(e) {
      if(taskList.moving == true){
        var task = taskList.element;

        task.style.position = "fixed"
        task.style.top = e.clientY -15 + "px";
      }
    },

    adjustTaskOrder: function(e){
      var task = e.target.parentNode;
      var displayedTasks = taskList.utility.getElementByAttribute("data-id");
      var id = parseInt(Task.getAttribute("data-id"));

      var contents = task.children[1].innerHTML;
      contents = contents.substr(5);

      for(var i = 0; i < displayedTasks.length; i++) {
        if(task.offsetTop < displayedTasks[i].offsetTop) {
          taskList.data.splice(id, 1);
          app.data.splice(i, 0, contents);

          break;
        }
      }

      if(task.offsetTop > displayedTasks[(displayedTasks.length - 1)].offsetTop) {
        taskList.data.splice(id, 1);
        taskList.data.push(contents);
      }

      taskList.getAllTasks();
    },

    deleteTask: function(e) {
      var task = e.target.parentNode;
      var id = parseInt(task.getAttribute("data-id"));

      taskList.data.splice(id, 1);

      taskList.getAllTasks();
    },

    utility: {
      getElementByAttribute: function(attribute) {
        var everthing = document.getElementsByTagName("*");
        var matchingElements = [];

        for(var i = 0; i < everything.length; i++) {
          if(everything[i].getAttribute(attribute)) {
            matchingElements.push(everytthing[i]);
          }
        }
        return matchingElements;
      }
    }
  }

  taskList.init();

})();

  </script>

<h1>This is the Page for my To DO List Project.</h1>
<!-- text, input and button for the to do list -->
<div id="toDoListContainer">

  <div id="errorText">-Error- Enter A Task -Error-</div><p></p>

  <div id="inputLabel">Enter a task</div>

  <input type ="text" id="taskInput" value="" placeholder="Enter a task">

  <input type="button" id="inputButton" value="+" onclick="TaskStart()"></button>

  <ul id="tasks"></ul>

  

</div>

</body>

</html>